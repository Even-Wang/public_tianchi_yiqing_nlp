# “公益AI之星”挑战赛-新冠疫情相似句对判定大赛 解决方案

## **Team**: tbam3  youfeng@buaa.edu.cn

## Index
1. 算法说明
2. 代码结构说明
3. 参考资料
____
## 1. 算法说明
本解决方案使用了基于病名\药名的数据增强+模型融合+训练时-测试时增强+伪标签的解决方案
* 基于病名\药名的数据增强 Data augmentation  

根据比赛组织方的信息，总共肺炎”、“支原体肺炎”、“支气管炎”、“上呼吸道感染”、“肺结核”、“哮喘”、“胸膜炎”、“肺气肿”、“感冒”、“咳血”十个病种，但是在train和dev数据集中仅仅出现了八个病种，其他的两个“肺结核”与“支气管炎”病种并没有出现，推测在test中包括了剩下的两个病种，是这次比赛的一个关键信息。  

本次比赛需要模型学习的内容主要包括以下几个点：匹配语义信息，病名信息，药名信息，病理信息，我们需要针对这四个点来进行数据增强。

在测试集中，“肺结核”和“支气管炎”两个病种的测试数据中显然含有我们已有标注数据没有的病名、药名信息，但是这些信息是较为易得的；对于语义匹配信息和病理信息，1. 其生成难度要远远高于前两者，2.且很可能改变原数据集中的语义匹配和病理信息，出于这两点考虑，本解决方案采取了替换原数据中病名\药名的数据增强。

在实现过程中，挑选了病理与“肺结核”、“支气管炎”较为接近的“支原体肺炎”与“哮喘”标注数据中的部分样本，作病名替换，添加到原始标注数据中作为训练数据集。

* 模型融合 models fushion

本解决方案使用了ernie + bert-wwm-ext + roberta-large-pair的融合模型，对最后的结果使用平均值。具体的来源和下载地址见参考资料。

* 训练时-测试时增强 train-test time augmentation

本解决方案中，在预测时，首先用原测试集预测一遍标签；然后将原测试集的query1和query2字段交换，再次预测一遍；最后将两个结果相加作为最后的预测结果。出于训练时模型拟合方向的偏差考虑，在训练时也训练了两种模型，分别用于预测正序\逆序时的数据集，这一做法的提高非常稳定。

这样的技巧是为了让模型在学习\预测过程中看到数据的更多方面，结合数据中包含的边角信息。

* 伪标签  pseudo label

在预测完成后，使用预测结果和原训练集一起作为新的训练集再次训练一个模型做预测。

## 2. 代码结构说明
```
project
	|-- README.md               # README说明
	|-- data
        |-- Dataset                 ## 官方提供的原始数据集
            |-- train.csv
            |-- dev.csv
            |-- test.csv
        |-- External                ## 额外资源
            |-- models                  ### 预训练模型
            |-- knowledge               ### 额外数据知识
	|-- user_data               # 用户数据文件夹
		|-- model_data              ## fine-tuned 模型        
        |-- tmp_data                ## 中间生成数据
	|-- code                    # 代码
		|-- run.sh                  ## 入口
        |-- run.py                  ## 训练、测试的代码
        |-- data_augmentation.py    ## 数据增强的代码
    	|-- prediction_result       # 预测结果文件夹
```
## 3. 参考资料
